<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
    <head>
        <title>Erweiterte Suche (SQL)</title>
        <meta name="author" content="Elmar Baumann" />
        <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
    </head>
    <body>

        <h1>Erweiterte Suche (SQL)</h1>

        <p>Mit der erweiterten Suche definieren Sie Bildauswahlen anhand
            bestimmter Kriterien, beispielsweise alle Bilder, auf denen Blumen
            abgebildet sind, die Sie an einem bestimmten Ort fotografierten.
            Sie können die Suche unter einem Namen <strong>speichern</strong>
            und zukünftig schnell ausführen durch Klicken auf den Suchnamen im
            Kartenreiter <a href="mainwindow_searches.html">Suchen</a>.
        </p>

        <p>Gesucht und gefunden werden Bilder, deren Metadaten in der
            Datenbank stehen.
        </p>

        <h2>Kartenreiter &quot;Stichwortkombinationen&quot;</h2>

        <p>Hier können Sie Stichwörter eintragen, die ein Bild <em>alle</em>
            haben muss, damit es gefunden wird.
        </p>

        <p>Die hier eingetragenen Stichwörter werden verknüpft mit den Eingaben
            des Kartenreiters <strong>Einfaches SQL</strong>.
        </p>

        <p><em>Die Suche findet nichts, falls Sie im Kartenreiter &quot;Einfaches
                SQL&quot; ein weiteres Stichwort nicht mit ODER verknüpfen!</em> Die
                Begründung steht weiter unten.
        </p>

        <h2>Kartenreiter &quot;Einfaches SQL&quot;</h2>

        <p>Im zweiten Dropdown-Listenfeld von links wählen Sie aus,
            <strong>was</strong> Sie suchen: Aufnahmezeit, Bildbeschreibung,
            Fotograf, ... Im folgenden Dropdown-Listenfeld wählen Sie aus,
            wie der folgende Suchtext interpretiert werden soll:
        </p>

        <ul>
            <li><strong>ist gleich</strong>: Der Suchbegriff steht <strong>genau
                so</strong> in der Datenbank. SQL: <strong>=</strong>.
            </li>
            <li><strong>passt auf</strong>: Der Suchbegriff entspricht einem
                <strong>Muster</strong>. SQL: <strong>LIKE</strong>. Fügen Sie
                Prozentzeichen (bedeutet: Keines oder beliebig viele Zeichen)
                hinzu für folgende Bedingungen:
                <ul>
                    <li><strong>Text soll am Anfang stehen</strong>:
                        Das Prozentzeichen steht nach dem Suchbegriff.
                        <code>Ei%</code> passt auf alles, das mit <code>Ei</code>
                        anfängt: <code>Ei, Eier, Einser, Eis, ...</code>
                    </li>
                    <li><strong>Text soll irgendwo stehen</strong>:
                        Das Prozentzeichen steht vor und nach dem Suchbegriff.
                        <code>%eier%</code> passt auf alles, das irgendwo
                        <code>eier</code> enthält: <code>Eier, Schlaumeier,
                            Eierbecher, Zweierbeziehung, ...</code>
                    </li>
                    <li><strong>Text soll am Ende stehen</strong>:
                        Das Prozentzeichen steht vor dem Suchbegriff.
                        <code>%en</code> passt auf Begriffe mit <code>en</code>
                        am Ende: <code>Einsen, Wiesen, Burgen, ...</code>
                    </li>
                </ul>
            </li>
            <li><strong>ungleich</strong>: Alles andere als der Suchbegriff
                (<strong>nicht</strong>; das Gegenteil von <strong>ist gleich</strong>):
                Alle Bilder, die nicht mit 50 mm Brennweite fotografiert wurden,
                alle Bilder, die nicht von Heinz fotografiert wurden, ... SQL:
                <strong>&lt;&gt;</strong>.
            </li>
            <li><strong>größer</strong>: Größer als der Suchbegriff
                (<strong>mehr als</strong>). Wird in der Regel für Zahlen
                benutzt: Welche Bilder wurden mit mehr als 200 ISO fotografiert,
                welche mit längerer Brennweite als 50 mm, welche nach dem
                01. Januar 2002? SQL: <strong>&gt;</strong>.
            </li>
            <li><strong>größer oder gleich</strong>:  Ist wie größer, schließt
                aber den Suchbegriff mit ein (<strong>mindestens</strong>).
                Größer als der 01. Januar 2000 findet erst Bilder ab dem 02.
                Januar 2000, größer gleich ab dem 01. Januar 2000. SQL:
                <strong>&gt;=</strong>.
            </li>
            <li><strong>kleiner</strong>:  Kleiner als der Suchbegriff
                (<strong>weniger als</strong>): Welche Bilder wurden vor dem 01.
                Januar 2000 fotografiert, welche mit weniger als 400 ISO? SQL:
                <strong>&lt;</strong>.
            </li>
            <li><strong>kleiner oder gleich</strong>:  Wie kleiner, der
                Suchbegriff wird aber mit eingeschlossen
                (<strong>höchstens</strong>): Welche Bilder wurden bis
                einschließlich 24.12.2007 fotografiert? SQL:
                <strong>&lt;=</strong>.
            </li>
        </ul>

        <p>Groß- und Kleinschreibung sind egal: Sie können nach
            <strong>meyer</strong> suchen oder nach <strong>Meyer</strong>,
            gefunden werden die gleichen Bilder.
        </p>

        <h3>Eingabeformate</h3>

        <p>Der Dialog versucht, für die Eingabefelder nur passende Formate
            zuzulassen. Geben Sie beispielsweise Buchstaben ein für eine
            ISO-Zahl, werden diese nicht angenommen. Ist ein Punkt zu sehen,
            steht dieser für ein Komma und Sie geben Zahlen so ein, dass ganze
            Zahlen vor dem Punkt enden. Mit den Pfeiltasten können Sie den
            Eingabecursor positionieren.
        </p>

        <h3>Suche nach Datum</h3>

        <p>Das Datumsformat ist: <code>JJJJ-MM-DD</code>: Das Jahr vierstellig,
            danach ein Bindestrich, folgend der Monat zweistellig, wieder ein
            Bindestrich und zuletzt der Tag zweistellig. Für den 24.12.2007
            geben Sie ein <code>2007-12-24</code>. Sie können auch den
            <strong>Kalender</strong> benutzen (Schaltfläche rechts).
        </p>

        <h3>Mehrere Suchbegriffe (Verknüpfungen)</h3>

        <p>Suchbegriffe können Sie verknüpfen mit <strong>und</strong> oder
            mit <strong>oder</strong>. <strong>Und</strong> bedeutet, der
            folgende Begriff muss auf jeden Fall in der Datenbank stehen,
            <strong>oder</strong> findet den folgenden Suchbegriff unabhängig
            vom vorhergehenden. Beispiele:
        </p>

        <ul>
            <li><code>Kamera ist gleich Nikon D300 <strong>und</strong>
                Aufnahmeort ist gleich München</code> findet Bilder, die mit der
                Nikon D300 in München fotografiert wurden
            </li>
            <li><code>Kamera ist gleich Nikon D300 <strong>oder</strong>
                Aufnahmeort ist gleich München</code> findet alle Bilder, die
                mit der Nikon D300 überall auf der Welt fotografiert wurden und
                zusätzlich alle Bilder, die in München mit jeder beliebigen
                Kamera fotografiert wurden
            </li>
            <li> <code>Datum größer gleich 2005-01-01 <strong>und</strong> Datum
                kleiner gleich 2005-12-31</code> findet alle Bilder, die im Jahr
                2005 fotografiert wurden
            </li>
            <li><code>Datum größer 2005-12-31 <strong>oder</strong> Datum
                kleiner 2005-01-01</code> findet alle Bilder vor 2005 und nach
                2005, also alle, die nicht 2005 fotografiert wurden
            </li>
        </ul>

        <p>Mit mehreren Suchbegriffen lassen sich versehentlich unlösbare
            Aufgaben stellen: <code>Stichwort ist gleich Baum UND Stichwort ist
            gleich Himmel</code> wird nie Bilder finden, da ein Stichwort
            entweder &quot;Baum&quot; heißt <em>oder</em> &quot;Himmel&quot;.
            Für diese Aufgabe gibt es den Kartenreiter
            <strong>Stichwortkombinationen</strong>.
        </p>

        <h3>Klammern</h3>

        <p>Mit Klammern lassen sich Probleme lösen wie: Finde alle Bilder, die
            vom Fotografen <code>Peter</code> oder vom Fotografen
            <code>Heinz</code> im Jahr <code>2006</code> fotografiert wurden.
            Die Anfrage <code>Fotograf ist gleich Peter oder Fotograf ist gleich
           Heinz und Aufnahmezeit größer gleich 2006-01-01 und Aufnahmezeit
            kleiner gleich 2006-12-31</code> findet zwar alle Bilder, die Peter
            und Heinz 2006 fotografierten, aber auch alle Bilder, die 2006 von
            irgendwem (anders) fotografiert wurden. Mit Klammern lässt sich die
            Abfrage richtig formulieren: <code>(Fotograf ist gleich Peter oder
           Fotograf ist gleich Heinz) und Aufnahmezeit größer gleich 2006-01-01
            und Aufnahmezeit kleiner gleich 2006-12-31</code>.
        </p>

        <p><em>Werden Klammern falsch gesetzt, erzeugt das einen Fehler!</em>
        </p>

        <h3>Spalten hinzufügen und Entfernen</h3>

        <p>Falls Ihnen die Spalten nicht ausreichen, können Sie weitere
            hinzufügen durch Betätigen der Schaltfläche <strong>Spalte
            hinzufügen</strong>. Sollte der Dialog nicht ausreichend groß
            gezogen sein oder wollen Sie diesen nicht größer ziehen, erscheint
            eine Scroll-Leiste mit der Sie die Spalten nach oben oder unten
            schieben können.
        </p>

        <p>Mit der Schaltfläche <strong>Spalte entfernen</strong> können Sie
            hinzugefügte Spalten entfernen (und nur diese).
        </p>

        <h2>Kartenreiter &quot;Eigenes SQL&quot;</h2>

        <p><em>Dieser Kartenreiter ist nur für Experten gedacht, die sich
            auskennen mit SQL und die Datenbankstruktur von JPhotoTagger
            kennen!</em> Die Gültigkeit einer Abfrage wird <em>nicht</em>
            geprüft!
        </p>

        <p>Die Ergebnistabelle einer SQL-Abfrage muss <code>files</code> sein
            mit der (einzigen, ersten) Spalte <code>filenames</code>: Die Namen
            der gefundenen Bilddateien.
        </p>

        <p>Da JPhotoTagger seine Datenbank stets aus den XML-Filialdateien
            aktualisiert, ist die Datenbankstruktur darauf ausgelegt, und nicht
            optimal normalisiert, sodass die Abfragen etwas komplexer ausfallen.
            Hier ist ein UML-Diagramm im SVG-Format, das die Beziehungen der
            Tabellen darstellt:
            <code>http://kenai.com/projects/jphototagger/sources/srcrepo/content/Support/res/developers/uml/database.svg</code>.
            Die Tabellenstrukturen stehen in folgender Quellcode-Datei:
            <code>http://kenai.com/projects/jphototagger/sources/srcrepo/content/Program/src/de/elmar_baumann/jpt/database/DatabaseTables.java</code>.
        </p>

        <p>Sie können alle SQL-Abfragen anzeigen, die <strong>JPhotoTagger</strong>
            ausführt: Stellen Sie das <a href="settings_misc.html">Protokoll</a>
            ein auf <strong>AM FEINSTEN</strong> und öffnen es über das Menü
            <strong>Fenster &gt; Programm-Ausgaben</strong>.
        </p>

        <p>Ist das Texteingabefeld dieses Kartenreiters ausgefüllt, werden
            Eingaben in andere Kartenreiter ignoriert.
        </p>

        <h2>Suchen speichern</h2>

        <p>Speichern Sie wichtige Suchen! Alle gespeicherten Suchen sehen Sie
            links im Programmfenster durch Klick auf den Kartenreiter
            <a href="mainwindow_searches.html">Suchen</a>. Dort
            lassen sie sich ändern, löschen und neu erzeugen durch Klick mit der
            <strong>rechten</strong> Maustaste auf eine gespeicherte Suche.
            Klicken Sie mit der <strong>linken</strong> Maustaste auf den Namen
            einer gespeicherten Suche, erscheinen alle gefundenen Bilder.
        </p>

        <h2>Siehe auch</h2>

        <ul>
            <li><a href="fast_search.html">Schnellsuche</a></li>
        </ul>

    </body>
</html>
